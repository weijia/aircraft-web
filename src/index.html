<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>飞行射击游戏</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
      background-color: #f0f0f0;
      text-align: center;
    }
    
    h1 {
      color: #333;
      margin-bottom: 20px;
    }
    
    #gameCanvas {
      display: block;
      background-color: #000;
      border: 2px solid #444;
      margin: 0 auto;
    }
    
    .controls {
      margin-top: 20px;
      padding: 10px;
      background-color: #fff;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      display: inline-block;
    }
    
    button {
      padding: 8px 16px;
      margin: 0 5px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    
    button:hover {
      background-color: #45a049;
    }
    
    .score-display {
      font-size: 24px;
      margin-top: 10px;
      font-weight: bold;
    }
    
    .instructions {
      margin-top: 20px;
      padding: 10px;
      background-color: #fff;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      text-align: left;
    }
    
    .instructions h2 {
      color: #333;
      margin-top: 0;
    }
    
    .instructions ul {
      padding-left: 20px;
    }
  </style>
</head>
<body>
  <h1>飞行射击游戏</h1>
  
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  
  <div class="score-display">
    分数: <span id="scoreValue">0</span>
  </div>
  
  <div class="controls">
    <button id="startButton">开始游戏</button>
    <button id="pauseButton">暂停</button>
    <button id="resetButton">重置</button>
  </div>
  
  <div class="instructions">
    <h2>游戏说明</h2>
    <ul>
      <li>使用方向键控制飞机移动</li>
      <li>按空格键发射子弹</li>
      <li>击中敌机可得分</li>
      <li>避免被敌机撞击</li>
    </ul>
  </div>

  <script>
    // 游戏变量
    let canvas, ctx;
    let gameRunning = false;
    let score = 0;
    
    // 玩家
    const player = {
      x: 400,
      y: 500,
      width: 50,
      height: 50,
      speed: 5,
      color: '#3498db'
    };
    
    // 子弹数组
    const bullets = [];
    const bulletSpeed = 7;
    const bulletCooldown = 300; // 毫秒
    let lastBulletTime = 0;
    
    // 敌机数组
    const enemies = [];
    const enemySpeed = 3;
    const enemySpawnRate = 1500; // 毫秒
    let lastEnemySpawn = 0;
    
    // 按键状态
    const keys = {
      left: false,
      right: false,
      up: false,
      down: false,
      space: false
    };
    
    // 初始化游戏
    function init() {
      canvas = document.getElementById('gameCanvas');
      ctx = canvas.getContext('2d');
      
      // 设置事件监听器
      document.getElementById('startButton').addEventListener('click', startGame);
      document.getElementById('pauseButton').addEventListener('click', pauseGame);
      document.getElementById('resetButton').addEventListener('click', resetGame);
      
      // 键盘事件
      window.addEventListener('keydown', handleKeyDown);
      window.addEventListener('keyup', handleKeyUp);
      
      // 初始绘制
      drawGame();
    }
    
    // 开始游戏
    function startGame() {
      if (!gameRunning) {
        gameRunning = true;
        gameLoop();
      }
    }
    
    // 暂停游戏
    function pauseGame() {
      gameRunning = false;
    }
    
    // 重置游戏
    function resetGame() {
      gameRunning = false;
      score = 0;
      updateScore();
      
      // 重置玩家位置
      player.x = canvas.width / 2;
      player.y = canvas.height - 100;
      
      // 清空子弹和敌机
      bullets.length = 0;
      enemies.length = 0;
      
      // 重绘
      drawGame();
    }
    
    // 处理按键按下
    function handleKeyDown(e) {
      switch(e.key) {
        case 'ArrowLeft':
          keys.left = true;
          break;
        case 'ArrowRight':
          keys.right = true;
          break;
        case 'ArrowUp':
          keys.up = true;
          break;
        case 'ArrowDown':
          keys.down = true;
          break;
        case ' ':
          keys.space = true;
          break;
      }
    }
    
    // 处理按键释放
    function handleKeyUp(e) {
      switch(e.key) {
        case 'ArrowLeft':
          keys.left = false;
          break;
        case 'ArrowRight':
          keys.right = false;
          break;
        case 'ArrowUp':
          keys.up = false;
          break;
        case 'ArrowDown':
          keys.down = false;
          break;
        case ' ':
          keys.space = false;
          break;
      }
    }
    
    // 更新游戏状态
    function update() {
      // 移动玩家
      if (keys.left) player.x -= player.speed;
      if (keys.right) player.x += player.speed;
      if (keys.up) player.y -= player.speed;
      if (keys.down) player.y += player.speed;
      
      // 限制玩家在画布内
      player.x = Math.max(player.width / 2, Math.min(canvas.width - player.width / 2, player.x));
      player.y = Math.max(player.height / 2, Math.min(canvas.height - player.height / 2, player.y));
      
      // 发射子弹
      const currentTime = Date.now();
      if (keys.space && currentTime - lastBulletTime > bulletCooldown) {
        bullets.push({
          x: player.x,
          y: player.y - player.height / 2,
          width: 5,
          height: 15,
          color: '#f1c40f'
        });
        lastBulletTime = currentTime;
      }
      
      // 移动子弹
      for (let i = bullets.length - 1; i >= 0; i--) {
        bullets[i].y -= bulletSpeed;
        
        // 移除超出画布的子弹
        if (bullets[i].y + bullets[i].height < 0) {
          bullets.splice(i, 1);
        }
      }
      
      // 生成敌机
      if (currentTime - lastEnemySpawn > enemySpawnRate) {
        enemies.push({
          x: Math.random() * (canvas.width - 40) + 20,
          y: -30,
          width: 40,
          height: 40,
          color: '#e74c3c'
        });
        lastEnemySpawn = currentTime;
      }
      
      // 移动敌机
      for (let i = enemies.length - 1; i >= 0; i--) {
        enemies[i].y += enemySpeed;
        
        // 移除超出画布的敌机
        if (enemies[i].y - enemies[i].height > canvas.height) {
          enemies.splice(i, 1);
        }
      }
      
      // 碰撞检测
      checkCollisions();
    }
    
    // 碰撞检测
    function checkCollisions() {
      // 子弹与敌机碰撞
      for (let i = bullets.length - 1; i >= 0; i--) {
        for (let j = enemies.length - 1; j >= 0; j--) {
          if (isColliding(bullets[i], enemies[j])) {
            // 增加分数
            score += 10;
            updateScore();
            
            // 移除子弹和敌机
            bullets.splice(i, 1);
            enemies.splice(j, 1);
            break;
          }
        }
      }
      
      // 玩家与敌机碰撞
      for (let i = enemies.length - 1; i >= 0; i--) {
        if (isColliding(player, enemies[i])) {
          // 游戏结束
          gameRunning = false;
          alert('游戏结束！你的分数是: ' + score);
          resetGame();
          break;
        }
      }
    }
    
    // 碰撞检测辅助函数
    function isColliding(obj1, obj2) {
      return (
        obj1.x - obj1.width/2 < obj2.x + obj2.width/2 &&
        obj1.x + obj1.width/2 > obj2.x - obj2.width/2 &&
        obj1.y - obj1.height/2 < obj2.y + obj2.height/2 &&
        obj1.y + obj1.height/2 > obj2.y - obj2.height/2
      );
    }
    
    // 绘制游戏
    function drawGame() {
      // 清空画布
      ctx.fillStyle = '#000';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      // 绘制玩家
      drawPlayer();
      
      // 绘制子弹
      drawBullets();
      
      // 绘制敌机
      drawEnemies();
    }
    
    // 绘制玩家
    function drawPlayer() {
      ctx.fillStyle = player.color;
      
      // 绘制三角形飞机
      ctx.beginPath();
      ctx.moveTo(player.x, player.y - player.height/2);
      ctx.lineTo(player.x + player.width/2, player.y + player.height/2);
      ctx.lineTo(player.x - player.width/2, player.y + player.height/2);
      ctx.closePath();
      ctx.fill();
    }
    
    // 绘制子弹
    function drawBullets() {
      bullets.forEach(bullet => {
        ctx.fillStyle = bullet.color;
        ctx.fillRect(
          bullet.x - bullet.width/2,
          bullet.y - bullet.height/2,
          bullet.width,
          bullet.height
        );
      });
    }
    
    // 绘制敌机
    function drawEnemies() {
      enemies.forEach(enemy => {
        ctx.fillStyle = enemy.color;
        
        // 绘制敌机（倒三角形）
        ctx.beginPath();
        ctx.moveTo(enemy.x, enemy.y + enemy.height/2);
        ctx.lineTo(enemy.x + enemy.width/2, enemy.y - enemy.height/2);
        ctx.lineTo(enemy.x - enemy.width/2, enemy.y - enemy.height/2);
        ctx.closePath();
        ctx.fill();
      });
    }
    
    // 更新分数显示
    function updateScore() {
      document.getElementById('scoreValue').textContent = score;
    }
    
    // 游戏循环
    function gameLoop() {
      if (gameRunning) {
        update();
        drawGame();
        requestAnimationFrame(gameLoop);
      }
    }
    
    // 页面加载完成后初始化游戏
    window.addEventListener('load', init);
  </script>
</body>
</html>